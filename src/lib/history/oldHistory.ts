import type {HistoricalEntry} from "$lib/utils.ts";
import autoGeneratedOldShows from "../../scripts/old-history-generator/output.json" assert { type: "json" };
import generatedTimeOverrides from "../../scripts/time-extractor/time-overrides.json" assert { type: "json" };

// Insert overrides here. Any overrides will replace auto-generated entries.
const overrides: HistoricalEntry[] = [
    {
        "name": "2021/07/09",
        "metadata": {
            "preShowStart": "2021-07-10T00:56:37.000Z",
            "mainShowStart": "2021-07-10T01:02:26Z",
            "showEnd": "2021-07-10T02:35:13Z",
            "title": "Cheap GPUs are FINALLY Coming Back!!",
            "vods": {
                "floatplane": "rocrk6qpHz",
                "youtube": "OvjrZprxGio"
            },
            "snippet": {
                "publishedAt": "2021-07-10T02:43:28Z",
                "channelId": "UCXuqSBlHAE6Xw-yeJA0Tunw",
                "title": "Cheap GPUs are FINALLY Coming Back!! - WAN Show July 9, 2021",
                "description": "Get 25% off Display Fusion with code WANSHOW at: https://lmg.gg/DisplayFusion\n\nUse code LTT for $50 off MAXNOMIC gaming chairs at https://geni.us/needforseat until July 18, 2021\n\nBuy a Seasonic Ultra Titanium PSU\nOn Amazon: https://geni.us/q4lnefC\nOn NewEgg: https://lmg.gg/8KV3S\n\nPodcast Download: https://anchor.fm/thewanshowpodcast/episodes/Cheap-GPUs-are-FINALLY-Coming-Back-----WAN-Show-July-9--2021-e14b3f3\n\nCheck out our other Podcasts:\nCarpool Critics Movie Podcast: https://www.youtube.com/channel/UCt-oJR5teQIjOAxCmIQvcgA\n\nTimestamps (Courtesy of NoKi1119)\n[0:00] Chapters\n[01:41] Intro\n[02:15] Topic #1: Cryptocurrency crackdown in China leading to Graphics Card prices to drop. \n   02:37 Reasons behind the drop in prices.\n   08:24 Discussing local prices.\n   10:19 eBay prices on GPUs are dropping.\n   11:30 The energy factor affecting Cryptomining in China.\n   13:25 Cryptocurrencies dipping and Linus wanting to invest.\n   15:34 The effect of chips shortage on the GPU pricing and future releases.\n[19:40] Topic #2: Biden directing F.T.C. to make new regulations for Right-to-Repair.\n   19:40 Biden issuing an Executive order towards F.T.C. and its regulations.\n   21:00 Right to Repair already exists in automotive repairs.\n   23:00 How the executive order helps farmers.\n   26:12 Directive includes DoD and mobile phone contractors.\n[29:14] Sponsors.\n   29:22 DisplayFusion multi-monitor manager.\n   30:23 NeedForSeat gaming chairs.\n   31:50  Seasonic Power Supply (and more).\n[32:54] Topic #2.5: Nintendo Switch \"Pro\" Controversy.\n   32:54 Expectations V.S. Reality.\n   36:48 Linus's experience with the Switch.\n   39:14 Linus appreciates Nintendo's consistency.\n   40:12 Linus's games of choice on Switch.\n[43:20] Topic #3: Google Playstore is under fire.\n   44:05 Google's Response to the whole lawsuit.\n   46:35 Google anti-consumer policies on subscription-based streaming services.\n   51:23 Lawsuit requires Google to \"allow\" for the removal of pre-installed apps.\n   53:22 Thoughts on Google's response.\n   56:02  LTTstore has a discount.\n[57:24] Topic #3.5: China uses Facial Recognition to control gamers.\n   58:25 Spending money on lootboxes  IS gambling.\n   59:46 Parents should enforce the limits, NOT the government.\n   1:00:50 China's 996 working hours system.\n[1:03:06] Topic #4: Linus's new house challenges.\n   1:04:46 The house heating problem.\n   1:06:40 Whole house water-cooling.?\n   1:08:47 Discussing computers.\n   1:13:57 Home theater.\n   1:17:46 Linus's home plan ft MsPaint.\n[1:22:44] Not-So-Superchats.\n[1:32:15] Wrapping up.\n[1:32:24] Outro.",
                "thumbnails": {
                    "default": {
                        "url": "https://i.ytimg.com/vi/OvjrZprxGio/default.jpg",
                        "width": 120,
                        "height": 90
                    },
                    "medium": {
                        "url": "https://i.ytimg.com/vi/OvjrZprxGio/mqdefault.jpg",
                        "width": 320,
                        "height": 180
                    },
                    "high": {
                        "url": "https://i.ytimg.com/vi/OvjrZprxGio/hqdefault.jpg",
                        "width": 480,
                        "height": 360
                    },
                    "standard": {
                        "url": "https://i.ytimg.com/vi/OvjrZprxGio/sddefault.jpg",
                        "width": 640,
                        "height": 480
                    }
                },
                "channelTitle": "Linus Tech Tips",
                "tags": [
                    "pcmr",
                    "building",
                    "competition",
                    "gamers",
                    "how to",
                    "review",
                    "intel",
                    "amd",
                    "cpu",
                    "gpu",
                    "gaming"
                ],
                "categoryId": "28"
            }
        }
    },
    {
        "name": "2021/09/17",
        "metadata": {
            "preShowStart": "2021-09-18T01:35:12.000Z",
            "mainShowStart": "2021-09-18T01:44:43Z",
            "showEnd": "2021-09-18T03:16:27Z",
            "title": "Did Apple Just Prove the iPhone Could be Cheaper?",
            "vods": {
                "floatplane": "WHfZYknvam",
                "youtube": "jPidIspifRM"
            },
            "snippet": {
                "publishedAt": "2021-09-18T03:25:51Z",
                "channelId": "UCXuqSBlHAE6Xw-yeJA0Tunw",
                "title": "Did Apple Just Prove the iPhone Could be Cheaper? - WAN Show September 17, 2021",
                "description": "Save 10% at Ridge Wallet with offer code WAN at https://www.ridge.com/WAN\n\nHead over to joinhoney.com/linus and start saving today\n\nBuy a Seasonic Ultra Titanium PSU\nOn Amazon: https://geni.us/q4lnefC\nOn NewEgg: https://lmg.gg/8KV3S\n\nPodcast Download: https://anchor.fm/thewanshowpodcast/episodes/Did-Apple-Just-Prove-the-iPhone-Could-be-Cheaper----WAN-Show-September-17--2021-e17k9te\n\nCheck out our other Podcasts:\nCarpool Critics Movie Podcast: https://www.youtube.com/channel/UCt-oJR5teQIjOAxCmIQvcgA\n\nTimestamps (Courtesy of NoKi1119)\n[0:00] Chapters.\n[1:31] Intro.\n[1:56] Colton blames Geoff for no sponsors.\n[4:06] Topic #1: Apple's annual September event.\n    5:57 A15 specs & Geekbench result.\n    9:35 ProRes enabled on iPhone 13 Pro.\n    13:56 iPhone & iPad Mini improvements.\n    15:22 Lightning vs USB C.\n    17:36 iPad Mini is a bigger iPhone.\n    20:33 iPad 9th Gen & Apple Watch Series 7.\n    21:34 Apple sued for \"Sherlocking\" apps.\n    29:34 Issues with OLED displays on Windows.\n[36:26] Sponsors.\n    36:40 Seasonic's Ultra Titanium PSUs.\n    37:51 Honey Promo Codes.\n    38:50 Ridge Wallet.\n[40:04] Topic #2: LG 325-Inch 8K \"Whole Wall\" TV.\n    41:32 DVLED Home Theater Cinema TV.\n    44:20 LG's peak watt usage & other specs.\n    49:38 Different modules for TV models.\n    55:14 Responding to chat regarding purchases.\n    1:00:20 AirBnB & other leisure renting.\n[1:04:55] Topic #3: FloatPlane early-access REMOVED.\n[1:07:07] LTTstore new merch.\n[1:08:18] Topic #4: Sennheiser's new HD 8xx.\n[1:11:38] Superchats & discussing Framework.\n[1:30:35] Wrapping up.\n[1:31:23] Outro.",
                "thumbnails": {
                    "default": {
                        "url": "https://i.ytimg.com/vi/jPidIspifRM/default.jpg",
                        "width": 120,
                        "height": 90
                    },
                    "medium": {
                        "url": "https://i.ytimg.com/vi/jPidIspifRM/mqdefault.jpg",
                        "width": 320,
                        "height": 180
                    },
                    "high": {
                        "url": "https://i.ytimg.com/vi/jPidIspifRM/hqdefault.jpg",
                        "width": 480,
                        "height": 360
                    },
                    "standard": {
                        "url": "https://i.ytimg.com/vi/jPidIspifRM/sddefault.jpg",
                        "width": 640,
                        "height": 480
                    }
                },
                "channelTitle": "Linus Tech Tips",
                "tags": [
                    "pcmr",
                    "building",
                    "competition",
                    "gamers",
                    "how to",
                    "review",
                    "intel",
                    "amd",
                    "cpu",
                    "gpu",
                    "gaming"
                ],
                "categoryId": "28"
            }
        }
    },
    {
        "name": "2021/09/10",
        "metadata": {
            "preShowStart": "2021-09-11T01:31:00.000Z",
            "mainShowStart": "2021-09-11T01:34:29Z",
            "showEnd": "2021-09-11T02:54:41Z",
            "title": "Apple WON... but also Lost",
            "vods": {
                "floatplane": "9uLS5T4TNV",
                "youtube": "1VW0uaoN5Yc"
            },
            "snippet": {
                "publishedAt": "2021-09-11T03:05:42Z",
                "channelId": "UCXuqSBlHAE6Xw-yeJA0Tunw",
                "title": "Apple WON... but also Lost - WAN Show September 10, 2021",
                "description": "Try JumpCloud for free at https://cloud.jumpcloud.com/WANshow\n\nHelp your IT team take care of support, maintenance, and security for Enterprise Linux systems with TuxCare at https://hubs.ly/H0WRkfb0\n\nTry FreshBooks free, for 30 days, no credit card required at https://www.freshbooks.com/wan\n\nPodcast Download: https://anchor.fm/thewanshowpodcast/episodes/Apple-WON----but-also-Lost---WAN-Show-September-10--2021-e17a83g\n\nCheck out our other Podcasts:\nCarpool Critics Movie Podcast: https://www.youtube.com/channel/UCt-oJR5teQIjOAxCmIQvcgA\n\nTimestamps (courtesy of NoKi1119)\n\n[0:00] Chapters.\n[1:20] Intro.\n[2:10] Topic #1: Apple VS Epic suit is FINALLY over.\n    6:26 Tim Sweeney's reaction.\n    9:37 Epic's developer Apple account.\n    11:02 Effects on the developers and consumers.\n[17:26] Topic #2: ProtonMail is not really private.\n    23:10 Changes and securing your mail.\n[25:30] Sponsors.\n    25:34 Jumpcloud Cloud Active Directory.\n    28:21 TuxCare Open Source Linux Support.\n    29:21 Freshbooks Accounting.\n[30:36] Topic #3: The Matrix Resurrections Trailer.\n    34:05 Linus criticizes the movie, genre & its' MMO.\n    40:51 PS Showcase & Star Wars remake.\n    43:12 Grand Theft Auto 5 Enhanced Edition delayed.\n[44:31] Topic #4: Facebook smart glasses.\n    46:02 Pricing and specs.\n    49:19 Better POV videos.\n    51:27 Comparing to Google Glass.\n[53:28] Topic #5: Valorant anti-cheat & TPM 2.0.\n[1:04:47] TechIngredient's thermal paste.\n[1:05:36] LTTstore new merch.\n[1:07:35] Superchats.\n[1:19:06] Wrapping up.\n[1:19:51] Outro.",
                "thumbnails": {
                    "default": {
                        "url": "https://i.ytimg.com/vi/1VW0uaoN5Yc/default.jpg",
                        "width": 120,
                        "height": 90
                    },
                    "medium": {
                        "url": "https://i.ytimg.com/vi/1VW0uaoN5Yc/mqdefault.jpg",
                        "width": 320,
                        "height": 180
                    },
                    "high": {
                        "url": "https://i.ytimg.com/vi/1VW0uaoN5Yc/hqdefault.jpg",
                        "width": 480,
                        "height": 360
                    },
                    "standard": {
                        "url": "https://i.ytimg.com/vi/1VW0uaoN5Yc/sddefault.jpg",
                        "width": 640,
                        "height": 480
                    }
                },
                "channelTitle": "Linus Tech Tips",
                "tags": [
                    "pcmr",
                    "building",
                    "competition",
                    "gamers",
                    "how to",
                    "review",
                    "intel",
                    "amd",
                    "cpu",
                    "gpu",
                    "gaming"
                ],
                "categoryId": "28"
            }
        }
    }
];


const timeOverrides = {
    ...generatedTimeOverrides,
    "2016/03/11": {
        "mainShowStart": "2016-03-11T16:49:51.000-08:00",
        // "showEnd": "2022-12-16T20:24:54.000-08:00"
    }
}



const historyBuilding: HistoricalEntry[] = autoGeneratedOldShows as HistoricalEntry[];
for (let i = 0; i < historyBuilding.length; i++) {
    const historicalEntry = historyBuilding[i];
    for (const override of overrides) {
        if(override.name == historicalEntry.name) {
            console.debug("Override found for ", override.name);
            historyBuilding[i] = override;
            break;
        }
    }
    for (const overrideShow in timeOverrides) {
        if(overrideShow != historicalEntry.name) continue;
        const times: TimeOverride = (timeOverrides as TimeOverrides)[overrideShow];
        if(times.preShowStart) {
            historyBuilding[i].metadata = {
                ...historyBuilding[i].metadata,
                preShowStart: times.preShowStart
            }
        }
        if(times.mainShowStart) {
            historyBuilding[i].metadata = {
                ...historyBuilding[i].metadata,
                mainShowStart: times.mainShowStart
            }
        }
        if(times.showEnd) {
            historyBuilding[i].metadata = {
                ...historyBuilding[i].metadata,
                showEnd: times.showEnd
            }
        } else if(times.mainShowStart && historicalEntry.metadata.mainShowLength) {
            // If there is a mainShowStart time but not a showEnd time, generate one based on mainShowLength
            const d = new Date(times.mainShowStart);
            d.setMilliseconds(d.getMilliseconds() + historicalEntry.metadata.mainShowLength);
            const showEnd = d.toISOString();
            console.log({overrideShow, showEnd})
            historyBuilding[i].metadata = {
                ...historyBuilding[i].metadata,
                showEnd
            }
        }
    }
}
export const history: HistoricalEntry[] = historyBuilding;

export type TimeOverrides = {
    [key: string]: TimeOverride
}
export type TimeOverride = {
    preShowStart?: string,
    mainShowStart?: string,
    showEnd?: string
}